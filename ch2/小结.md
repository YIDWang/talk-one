### 背景

经历两周的学习完成了 CPU 相关的调优的学习，了解了各式各样的工具，本周在某个项目小试牛刀。
	
### 实践

此项目是典型的微服务工程，部署在云上，主要功能是串联各个服务，做消息分发。有点类似于网管服务，又有点像消息总线。废话不多说，开始实践。

通过压测工具发现服务在消耗到 30 核就上不去了，物理机器为 48核数。观测 网卡 & 磁盘 都有比较有压力。那具体是哪里问题呢？

使用 pidstat 查看，机器的软中断和硬中断都不是很多，排除了磁盘和网卡影响。但是究竟是哪里问题呢？日志中有大量 io timeout ，猜测是下游服务瓶颈。通过网上查询，发现可以通过netstat 查看机器丢包情况，发现机器有少量丢包。

验证问题 通过扩容下游服务，服务性能机器使用cpu数上去了。

### 总结

微服务大部分性能消耗在下游服务，因此我们可以通过抓包和tcpdump 判断。这些会在后章学习。